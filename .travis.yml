os: linux
dist: xenial
language: generic

before_install:
  - sudo apt-get update
  - sudo apt-get -y install openjdk-8-jdk repo bc git-core gnupg flex bison gperf libsdl1.2-dev libesd0-dev libwxgtk2.8-dev squashfs-tools build-essential zip curl libncurses5-dev zlib1g-dev openjdk-8-jre openjdk-8-jdk pngcrush schedtool libxml2 libxml2-utils xsltproc lzop libc6-dev schedtool g++-multilib lib32z1-dev lib32ncurses5-dev lib32readline-gplv2-dev gcc-multilib maven tmux screen w3m ncftp
  - cd $HOME && mkdir android

before_script:
  - cd $HOME/android
  - repo init -u https://github.com/ResurrectionRemix/platform_manifest.git -b pie
  - repo sync -f --force-sync --no-clone-bundle
  - cp $TRAVIS_BUILD_DIR/* .

script:
  - cd $HOME/android
  - . build/envsetup.sh && brunch k7000
  - make recoveryimage

deploy:
  strategy: git
  provider: pages
  cleanup: false
  token: $GITHUB_TOKEN
  keep_history: true
  on:
    branch: master
  local_dir: $HOME/android/out
